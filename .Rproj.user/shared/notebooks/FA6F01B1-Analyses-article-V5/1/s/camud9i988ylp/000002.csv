"0",""
"0","# What to consider as a relapse ? Here everything except acute seizures"
"0",""
"0","# pas de ttt                        "
"0","#ttt ok et bonne compliance        "
"0","#Probleme de compliance            "
"0","#ttt ok taux infra ou ttt inadequat"
"0","#crise provoquee"
"0",""
"0","data_relapse <- data_full_cleaned%>%"
"0","  select(code.pat, dx.event, dx.epi, type.epi.final, n.tot.recidives, motif_relapse, detail_relapse)%>%"
"0","  mutate(dx.dicho = ifelse(dx.event != ""Epilepsy"" | is.na(dx.event), ""Non epileptic"", ""Epileptic""), "
"0","         relapses = case_when(n.tot.recidives == 0 ~ ""No relapse"","
"0","                              dx.dicho == ""Non epileptic"" & n.tot.recidives > 0 ~ ""Relapse"","
"0","                              detail_relapse == ""pas de ttt"" ~ ""Relapse"","
"0","                              detail_relapse == ""ttt ok et bonne compliance"" ~ ""Relapse"","
"0","                              detail_relapse == ""Probleme de compliance"" ~ ""Relapse"","
"0","                              detail_relapse == ""ttt ok taux infra ou ttt inadequat"" ~ ""Relapse"","
"0","                              motif_relapse == ""pas de recidives trouvees"" ~ ""No relapse"","
"0","                              TRUE ~ ""No relapse""))%>%"
"0","  select(code.pat, dx.event, dx.epi, type.epi.final, relapses, detail_relapse, dx.dicho)"
"0",""
"0","# Table of the relapse rate per diagnostis"
"0",""
"0","relapse_table <- data_relapse%>%"
"0","  group_by(dx.event, dx.epi, type.epi.final, relapses)%>%"
"0","  summarise(N = n())%>%"
"0","  mutate()%>%"
"0","  spread(key = relapses, value = N)%>%"
"0","  mutate(percentage = pct.fun(Relapse, sum(`No relapse`, Relapse)),"
"0","         pct_n = pct.fun_n(Relapse, sum(`No relapse`, Relapse)))"
"0",""
"0","# N and % of acutes symptomatic seizures as relapse"
"0",""
"0","N_acute_relapses <- nrow(data_relapse%>%"
"0","  filter(detail_relapse == ""crise provoquee""))"
"0",""
"0","pct_acute_relapses <- pct.fun(N_acute_relapses, nrow(data_full_cleaned%>%filter(dx.event == ""Epilepsy"")))"
"0",""
"0","# General relapse rate among all patients "
"0",""
"0","N_relapses_total <- nrow(data_relapse%>%filter(relapses == ""Relapse""))"
"0",""
"0","# N and % of relapse among epileptic patients"
"0","N_relapses_epi <- nrow(data_relapse%>%filter(dx.event == ""Epilepsy"", relapses == ""Relapse""))"
"0",""
"0","pct_relapses_epi <- pct.fun(N_relapses_epi, nrow(data_relapse%>%filter(dx.event == ""Epilepsy"")))"
"0",""
"0","# N and % of relapse among non-epileptic patients"
"0",""
"0","N_relapses_non_epi <- nrow(data_relapse%>%"
"0","                             filter(dx.event != ""Epilepsy"" | is.na(dx.event))%>%"
"0","                             filter(relapses == ""Relapse""))"
"0",""
"0","N_non_epi <- nrow(data_relapse%>%"
"0","                             filter(dx.event != ""Epilepsy"" | is.na(dx.event)))"
"0",""
"0","pct_relapses_non_epi <- pct.fun(N_relapses_non_epi, N_non_epi)"
"0",""
"0","# Chisq between the two"
"0","N_no_relapse_epi <- nrow(data_relapse%>%filter(dx.event == ""Epilepsy"", relapses == ""No relapse""))"
"0","N_no_relapse_non_epi <-  nrow(data_relapse%>%"
"0","                             filter(dx.event != ""Epilepsy"" | is.na(dx.event))%>%"
"0","                             filter(relapses == ""No relapse""))"
"0",""
"0","epi_rel_no_rel <- c(N_relapses_epi, N_no_relapse_epi)"
"0","non_epi_rel_no_rel <- c(N_relapses_non_epi, N_no_relapse_non_epi)"
"0",""
"0","chi_data <- data.frame(epi_rel_no_rel, non_epi_rel_no_rel)"
"0","result_chi_epi_non_epi <- chisq.test(chi_data)"
"0",""
"0","# N and % of relapse in focal epilepsy patients vs. generalized"
"0","  # Focal"
"0","N_relapses_focal <- nrow(data_relapse%>%filter(dx.epi == ""Focal epilepsy"", relapses == ""Relapse""))"
"0","N_focal <- nrow(data_relapse%>%filter(dx.epi == ""Focal epilepsy""))"
"0",""
"0","pct_relapses_focal <- pct.fun(N_relapses_focal, N_focal)"
"0",""
"0","  # Generalized"
"0","N_relapses_generalized <- nrow(data_relapse%>%filter(dx.epi == ""Primary generalized epilepsy"", relapses == ""Relapse""))"
"0","N_generalized <- nrow(data_relapse%>%filter(dx.epi == ""Primary generalized epilepsy""))"
"0",""
"0","pct_relapses_generalized <- pct.fun(N_relapses_generalized, N_generalized)"
"0",""
"0","# Chisq on the relapse rate between focal and generalized"
"0","N_no_relapses_focal <- nrow(data_relapse%>%filter(dx.epi == ""Focal epilepsy"", relapses == ""No relapse""))"
"0","N_no_relapses_generalized <- nrow(data_relapse%>%filter(dx.epi == ""Primary generalized epilepsy"", relapses == ""No relapse""))"
"0",""
"0","focal_rel_no_rel <- c(N_relapses_focal, N_no_relapses_focal)"
"0","gener_rel_no_rel <- c(N_relapses_generalized, N_no_relapses_generalized)"
"0",""
"0","data_chi <- data.frame(focal_rel_no_rel, gener_rel_no_rel)"
"0","res_chi_focal_gen <- chisq.test(data_chi)"
"0",""
"0","# N and % of relapses in lesional vs. non-lesional epilepsy"
"0","N_relapses_les <- nrow(data_relapse%>%filter(type.epi.final == ""lesionnelle"", relapses == ""Relapse""))"
"0",""
"0","N_les <- nrow(data_relapse%>%filter(type.epi.final == ""lesionnelle""))"
"0",""
"0","pct_relapses_les <- pct.fun(N_relapses_les, N_les)"
"0",""
"0","N_relapses_non_les <- nrow(data_relapse%>%filter(type.epi.final == ""non lesionnelle"", relapses == ""Relapse""))"
"0","N_non_les <- nrow(data_relapse%>%filter(type.epi.final == ""non lesionnelle""))"
"0",""
"0","pct_relapses_non_les <- pct.fun(N_relapses_non_les, N_non_les)"
"0",""
"0","# Chisq on the relapse rate between lesional vs. non-lesional patients"
"0",""
"0","N_non_relapses_les <- N_les - N_relapses_les"
"0","N_non_relapses_non_les <- N_non_les - N_relapses_non_les"
"0",""
"0","les_rel_no_rel <- c(N_relapses_les, N_non_relapses_les)"
"0","non_les_rel_no_rel <- c(N_relapses_non_les, N_non_relapses_non_les)"
"0",""
"0","data_chi <- data.frame(les_rel_no_rel, non_les_rel_no_rel)"
"0","res_chi_les_non_les <- chisq.test(data_chi)"
"0",""
"0","# Cardiac RR vs. the other groups of non-epileptic patients"
"0","N_relapses_cardiac <- nrow(data_relapse%>%filter(dx.event == ""Cardiac"", relapses == ""Relapse""))"
"0","N_cardiac <- nrow(data_relapse%>%filter(dx.event == ""Cardiac""))"
"0",""
"0","pct_relapses_cardiac <- pct.fun(N_relapses_cardiac, N_cardiac)"
"0",""
"0","data_cardiac_relapse <- relapse_table%>%"
"0","  mutate(cardiac.dicho = case_when(dx.event == ""Cardiac"" ~ ""Cardiac"","
"0","                                   TRUE ~ ""non cardiac""),"
"0","         cardiac.dicho = ifelse(dx.event == ""Epilepsy"", NA, cardiac.dicho),"
"0","         cardiac.dicho = ifelse(is.na(dx.event), ""non cardiac"", cardiac.dicho))"
"0",""
"0",""
"0","data_cardiac_relapse <- as.data.frame(data_cardiac_relapse)"
"0","N_relapses_non_cardiac <- data_cardiac_relapse%>%filter(cardiac.dicho == ""non cardiac"")%>%"
"0","  summarise(total = sum(Relapse))"
"0","N_relapses_non_cardiac <-  N_relapses_non_cardiac$total[1]"
"0",""
"0","N_non_cardiac <- data_cardiac_relapse%>%filter(cardiac.dicho == ""non cardiac"")%>%"
"0","  summarise(total = sum(Relapse, `No relapse`))"
"0",""
"0","data_cardiac_relapse <- as.data.frame(data_cardiac_relapse)"
"0",""
"0","# Chisq between cardiac and non-cardiac diagnoses"
"0","N_non_relapses_non_cardiac <- as.data.frame(data_cardiac_relapse%>%filter(cardiac.dicho == ""non cardiac"")%>%summarise(total = sum(`No relapse`)))"
"0","N_non_relapses_non_cardiac <- N_non_relapses_non_cardiac$total"
"0",""
"0","N_non_relapses_cardiac <- N_cardiac - N_relapses_cardiac"
"0","cardiac_rel_no_rel <- c(N_relapses_cardiac, N_non_relapses_cardiac)"
"0","non_cardiac_rel_no_rel <- c(N_relapses_non_cardiac, N_non_relapses_non_cardiac)"
"0","data_chi <- data.frame(cardiac_rel_no_rel, non_cardiac_rel_no_rel)"
"0",""
"0","res_chi_cardiac <- chisq.test(data_chi)"
"0",""
"0","table_5 <- relapse_table"
"0",""
